extends layout
block content
	script.
		$(document).ready(function() {
			$('.onoffswitch-checkbox').on('click touch', function() {

				var check = $(this).attr('checked');
				console.log('checked? '+ check);

				if(check === true) {

					$.ajax ({
						type : 'POST',
						url : '/settings?field='+ this.id,
						data : {
							checked : true
						}
					});
				} 
				if(check === undefined) {
				console.log('undefined reached');
					$.ajax ({
						type : 'POST',
						url : '/settings?field='+ this.id,
						data : {
							checked : false
						}
					});
				}

			});
		});
	.container
		include includes/nav.jade
		.settingsWrap
			h1 Settings
			.settingsA
				.settingsAccount
					h2 Account
					a(href='/settings/change?field=username')
						.setting
							.settingTitle
								p username
							.settingInput
								p #{user.username}	
					a(href='/settings/change?field=email')
						.setting
							.settingTitle
								p email
							.settingInput
								p #{user.email}
					if (user.provider === 'local')
						a(href='/settings/change?field=password')
							.setting
								.settingTitle
									p password
								.settingInput
									p ***********
					a(href='/delete')
						.setting
							.settingTitle
								p account
							.settingInput
								p delete account
			.settingsN
				.settingsNotification
					h2 Notifications
					.notifyError
					.setting
						.section
							button.js-push-btn(disabled) Enable push messaging
							section.subscription-details.js-subscription-details.is-invisible
								p.
									Once you've subscribed your user, you'd send their subscription to your server to store in a database so that when you want to send a message you can lookup the subscription and send a message to it.
									To simplify things for this code lab copy the following details into the 
								a(href="https://web-push-codelab.appspot.com/") Push Companion Site 
								p.
									and it'll send a push message for you, using the application server keys on the site - so make sure they match.
								pre
									code.js-subscription-json
						.settingTitle
							p messages
						.onoffswitch
							if (user.notifyChat === true)
								input.onoffswitch-checkbox#notifyChat(type='checkbox', name='notifyChat', checked=true)
							else
								input.onoffswitch-checkbox#notifyChat(type='checkbox', name='notifyChat', checked=false)
							label.onoffswitch-label(for='notifyChat')
								span.onoffswitch-inner
								span.onoffswitch-switch
					.setting
						.settingTitle
							p forum replies
						.onoffswitch
							if (user.notifyForum === true)
								input.onoffswitch-checkbox#notifyForum(type='checkbox', name='notifyForum', checked=true)
							else
								input.onoffswitch-checkbox#notifyForum(type='checkbox', name='notifyForum', checked=false)
							label.onoffswitch-label(for='notifyForum')
								span.onoffswitch-inner
								span.onoffswitch-switch
			.settingsC
				.settingsChat
					h2 Video Chat
					.setting
						.settingTitle
							p microphone
						.onoffswitch
							if (user.defaultMic === true)
								input.onoffswitch-checkbox#defaultMic(type='checkbox', name='defaultMic', checked=true)
							else
								input.onoffswitch-checkbox#defaultMic(type='checkbox', name='defaultMic', checked=false)
							label.onoffswitch-label(for='defaultMic')
								span.onoffswitch-inner
								span.onoffswitch-switch
					.setting
						.settingTitle
							p webcam
						.onoffswitch
							if (user.defaultVideo === true)
								input.onoffswitch-checkbox#defaultVideo(type='checkbox', name='defaultVideo', checked=true)
							else
								input.onoffswitch-checkbox#defaultVideo(type='checkbox', name='defaultVideo', checked=false)
							label.onoffswitch-label(for='defaultVideo')
								span.onoffswitch-inner
								span.onoffswitch-switch
	script(src='/js/notifications.js')